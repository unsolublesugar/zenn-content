---
title: "Unity 2022ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆæ™‚ã«ç™ºç”Ÿã—ãŸã‚¨ãƒ©ãƒ¼å¯¾å¿œãƒ¡ãƒ¢"
emoji: "ðŸ› ï¸"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [unity, iOS, AdMob, firebase]
published: true
---

ã¨ã‚ã‚‹Unityã‚¢ãƒ—ãƒªé–‹ç™ºã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã¦ã€é–‹ç™ºç’°å¢ƒã‚’Unity 2021ã‹ã‚‰2022ã¸ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã—ãŸéš›ã«ç™ºç”Ÿã—ãŸã‚¨ãƒ©ãƒ¼ã®å¯¾å¿œãƒ¡ãƒ¢ã§ã™ã€‚


:::message
ç’°å¢ƒ: Unity 2021.3.37f1 -> 2022.3.25f1
:::

## Reference has errors 'Google.IOSResolver'.

```shell
Assembly 'Library/ScriptAssemblies/Assembly-CSharp-Editor.dll' will not be loaded due to errors:
Reference has errors 'Google.IOSResolver'.
```

### åŽŸå› 
Unityã«iOSãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„å ´åˆã«ç™ºç”Ÿã™ã‚‹ã‚¨ãƒ©ãƒ¼ã€‚

### å¯¾å¿œ

Unity Hubã®Installsã«ã¦å¯¾è±¡ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®Unityã‚’é¸æŠžã€‚`Add modules`ã‹ã‚‰ `iOS Build Support` ã‚’è¿½åŠ ã—ã¦è§£æ¶ˆã€‚

![](https://storage.googleapis.com/zenn-user-upload/a2730efac6c8-20240605.png)

![](https://storage.googleapis.com/zenn-user-upload/f53a8066dc61-20240605.png)

### å‚è€ƒ

> Check if you have iOS module installed for your unity editor. If not, install it from unity hub.
> 
> https://forum.unity.com/threads/google-iosresolver-will-not-be-loaded-in-2021-1-11f1-and-later.1128617/#post-9101890

## System.InvalidOperationException: Insecure connection not allowed


```shell
Job failed with exception: System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation. ---> System.InvalidOperationException: Insecure connection not allowed
  at (wrapper managed-to-native) UnityEngine.Networking.UnityWebRequest.BeginWebRequest(UnityEngine.Networking.UnityWebRequest)
  at UnityEngine.Networking.UnityWebRequest.SendWebRequest () [0x00001] in <ce006d9cdd7f42a88f73d37c00d20828>:0 
  at (wrapper managed-to-native) System.Reflection.RuntimeMethodInfo.InternalInvoke(System.Reflection.RuntimeMethodInfo,object,object[],System.Exception&)
  at System.Reflection.RuntimeMethodInfo.Invoke (System.Object obj, System.Reflection.BindingFlags invokeAttr, System.Reflection.Binder binder, System.Object[] parameters, System.Globalization.CultureInfo culture) [0x0006a] in <b11ba2a8fbf24f219f7cc98532a11304>:0 
   --- End of inner exception stack trace ---
  at System.Reflection.RuntimeMethodInfo.Invoke (System.Object obj, System.Reflection.BindingFlags invokeAttr, System.Reflection.Binder binder, System.Object[] parameters, System.Globalization.CultureInfo culture) [0x00083] in <b11ba2a8fbf24f219f7cc98532a11304>:0 
  at System.Reflection.MethodBase.Invoke (System.Object obj, System.Object[] parameters) [0x00000] in <b11ba2a8fbf24f219f7cc98532a11304>:0 
  at Google.PortableWebRequest.StartRequest (Google.PortableWebRequest+HttpMethod method, System.String url, System.Collections.Generic.IDictionary`2[TKey,TValue] headers, UnityEngine.WWWForm form) [0x0019e] in <3d721d59d99942a585ced249e28ec6ca>:0 
  at Google.PortableWebRequest+<StartRequestOnMainThread>c__AnonStorey6.<>m__C () [0x00000] in <3d721d59d99942a585ced249e28ec6ca>:0 
  at Google.RunOnMainThread.ExecuteNext () [0x0003d] in <3d721d59d99942a585ced249e28ec6ca>:0 
UnityEngine.Debug:LogError (object)
Google.RunOnMainThread:ExecuteNext ()
Google.RunOnMainThread:<ExecuteAllUnnested>m__12 ()
Google.RunOnMainThread:RunAction (System.Action)
Google.RunOnMainThread:ExecuteAllUnnested (bool)
Google.RunOnMainThread:ExecuteAll ()
UnityEditor.EditorApplication:Internal_CallUpdateFunctions ()
```

### åŽŸå› 
Unity 2022ä»¥å¾Œã§ã¯ã€HTTPçµŒç”±ã§ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’è¨±å¯ã—ãªã„è¨­å®šãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¨ãªã£ã¦ã„ã‚‹ã€‚

> HTTP çµŒç”±ã§ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’è¨±å¯ã™ã‚‹ã‹ã©ã†ã‹æŒ‡å®šã—ã¾ã™ã€‚é¸æŠžå¯èƒ½ãªã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ Not allowedã€Allowed in Development builds onlyã€Always allowed ã§ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ Not allowed ã§ã™ã€‚ã“ã‚Œã¯ã€ã‚ˆã‚Šå®‰å…¨ãªãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã‚ã‚‹ HTTPS ãŒæŽ¨å¥¨ã•ã‚Œã‚‹ãŸã‚ã§ã™ã€‚
>
> https://docs.unity3d.com/ja/2022.3/Manual/class-PlayerSettingsWebGL.html

Firebaseã‚„AdMobãªã©ã€Googleç³»ã®ãƒ‡ãƒ¼ã‚¿è§£æžãƒ»åºƒå‘ŠSDKã‚’å°Žå…¥ã—ã¦ã„ã‚‹å ´åˆã€Editorã®ä½¿ç”¨çŠ¶æ³ãƒ¬ãƒãƒ¼ãƒˆé€ä¿¡ã§httpé€šä¿¡ãŒè¡Œã‚ã‚Œã¦ã„ã‚‹ã“ã¨ãŒåŽŸå› ã€‚

> EditorMeasurement used to use http:// instead of https:// to report editor usage. This is causing later version of Unity to log warnings and errors. Even though this is harmless, the logs still looks concerning.
> 
> https://github.com/googlesamples/unity-jar-resolver/pull/548

### å¯¾å¿œ
[unity-jar-resolver](https://github.com/googlesamples/unity-jar-resolver)ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ã€è©²å½“ã™ã‚‹ãƒ¬ãƒãƒ¼ãƒˆé€ä¿¡ã‚’ç„¡åŠ¹ã«ã™ã‚‹ã€‚
ä»¥ä¸‹è¨­å®šã®Enable Analytics Reportingã®ãƒã‚§ãƒƒã‚¯ã‚’å¤–ã—ã€OKãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§ä¿å­˜ã—ã¦è§£æ¶ˆã€‚

##### Assets > External Dependency Manager > Version Handler > Settings

![](https://storage.googleapis.com/zenn-user-upload/d62d6884bd83-20240605.png)

ãªãŠã€Unityã‚¨ãƒ‡ã‚£ã‚¿ã®Project Settingsã«ã¦ `Allow downloads over HTTP` ã‚’ `Always allowed` ã¸å¤‰æ›´ã—ã¦ã‚‚ã‚¨ãƒ©ãƒ¼è§£æ¶ˆå¯èƒ½ã ãŒã€HTTPé€šä¿¡ã¯éžæŽ¨å¥¨ã§ã‚ã‚‹ãŸã‚ã€å‰è¿°ã®è¨­å®šå¤‰æ›´ã‚’è¡Œã†ã‹ã€å¤–éƒ¨é€šä¿¡æ™‚ã®æŽ¥ç¶šå¯¾è±¡ã‚’HTTPSã«é™å®šã™ã‚‹å½¢ãŒæœ›ã¾ã—ã„ã€‚

### å‚è€ƒ

#### Enable Analytics Reportingã®è¨­å®šå¤‰æ›´

> Thank you for reporting this issue. Seems like Unity 2022 added some security feature which blocks the non-https web request. I wonder why it used http in the first place.
> 
> At the meantime, as a workaround, I would recommend you to disable Analytics reporting from our editor tools for now. Here are all the settings:
> 
> EDM4U: Assets > External Dependency Manager > Version Handler > Settings > Enable Analytics Reporting
> Firebase: Windows > Firebase > Documentation > Enable Analytics Reporting (At the very bottom)
> 
> https://github.com/googlesamples/unity-jar-resolver/issues/484#issuecomment-993910648

#### Allow downloads over HTTPã®è¨­å®šå¤‰æ›´

> Solved this by (Workaround): Edit -> Project Settings -> Player -> Other Settings -> Configuration -> Allow downloads over HTTP
set "Always allowed"...
>
> https://forum.unity.com/threads/job-failed-with-exception-system-reflection-targetinvocationexception-unity-error.1294134/#post-8590033