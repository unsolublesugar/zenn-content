---
title: "Windowsã§jqã‚³ãƒãƒ³ãƒ‰ã‚’å°å…¥ã—ã¦JSONãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’æ•´å½¢ãƒ»æŠ½å‡ºã™ã‚‹"
emoji: "ğŸ¡"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [windows, jq, curl, json]
published: true
publication_name: "easy_easy"
---
# jqã‚³ãƒãƒ³ãƒ‰ã¯ã„ã„ã
Macã®curlã§æ„›ç”¨ã—ã¦ã„ã‚‹jqã‚³ãƒãƒ³ãƒ‰ã‚’Windowsã§ã‚‚ä½¿ã„ãŸã‹ã£ãŸã®ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã—ãŸã€‚
https://stedolan.github.io/jq/

æ™®é€šã«curlã‚³ãƒãƒ³ãƒ‰ã‚’å©ã„ãŸå ´åˆã€JSONãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¯1è¡Œè¡¨ç¤ºã§å‡ºåŠ›ã•ã‚Œã¾ã™ã€‚ã¾ãŸã€æ—¥æœ¬èªæ–‡å­—åˆ—ã¯ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã•ã‚Œã¦å†…å®¹ãŒã‚ˆãã‚ã‹ã‚Šã¾ã›ã‚“ã€‚
```shell
$ curl "http://geoapi.heartrails.com/api/json?method=searchByPostal&postal=1620067"
{"response":{"location":[{"city":"\u65b0\u5bbf\u533a","city_kana":"\u3057\u3093\u3058\u3085\u304f\u304f","town":"\u5bcc\u4e45\u753a","town_kana":"\u3068\u307f\u3072\u3055\u3061\u3087\u3046","x":"139.716002","y":"35.693258","prefecture":"\u6771\u4eac\u90fd","postal":"1620067"}]}}
```

jqã‚³ãƒãƒ³ãƒ‰ã‚’å°å…¥ã™ã‚‹ã¨ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®å‡ºåŠ›ãŒæ•´å½¢ã•ã‚Œã¦è¦‹ã‚„ã™ããªã£ãŸã‚Šã€ãƒ•ã‚£ãƒ«ã‚¿æ©Ÿèƒ½ã§å¿…è¦ãªæƒ…å ±ã ã‘ã‚’æŠ½å‡ºã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```shell
$ curl 'https://api.github.com/repos/stedolan/jq/commits?per_page=5'
[
  {
    "sha": "d25341478381063d1c76e81b3a52e0592a7c997f",
    "commit": {
      "author": {
        "name": "Stephen Dolan",
        "email": "mu@netsoc.tcd.ie",
        "date": "2013-06-22T16:30:59Z"
      },
      "committer": {
        "name": "Stephen Dolan",
        "email": "mu@netsoc.tcd.ie",
        "date": "2013-06-22T16:30:59Z"
      },
      "message": "Merge pull request #162 from stedolan/utf8-fixes\n\nUtf8 fixes. Closes #161",
      "tree": {
        "sha": "6ab697a8dfb5a96e124666bf6d6213822599fb40",
        "url": "https://api.github.com/repos/stedolan/jq/git/trees/6ab697a8dfb5a96e124666bf6d6213822599fb40"
      },
      "url": "https://api.github.com/repos/stedolan/jq/git/commits/d25341478381063d1c76e81b3a52e0592a7c997f",
      "comment_count": 0
    },
    "url": "https://api.github.com/repos/stedolan/jq/commits/d25341478381063d1c76e81b3a52e0592a7c997f",
    "html_url": "https://github.com/stedolan/jq/commit/d25341478381063d1c76e81b3a52e0592a7c997f",
    "comments_url": "https://api.github.com/repos/stedolan/jq/commits/d25341478381063d1c76e81b3a52e0592a7c997f/comments",
    "author": {
      "login": "stedolan",
...
```
è¶…çµ¶ä¾¿åˆ©ã€‚

# jqã‚³ãƒãƒ³ãƒ‰ã®å°å…¥æ–¹æ³•
ã•ã£ããå°å…¥ã—ã¦ã„ãã¾ã™ã€‚
## exeã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
[å…¬å¼ã‚µã‚¤ãƒˆ](https://stedolan.github.io/jq/)ã¸ã‚¢ã‚¯ã‚»ã‚¹ã—ã€Windowsç”¨ã®exeã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚
![](https://storage.googleapis.com/zenn-user-upload/ho4zy92wbnpgnmsomltu6vpfrnd1)
ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸexeãƒ•ã‚¡ã‚¤ãƒ«ã®åå‰ã‚’`jq-win64.exe`ã‹ã‚‰`jq.exe`ã«ãƒªãƒãƒ¼ãƒ ã—ã¦ãŠãã¨ã€ã‚³ãƒãƒ³ãƒ‰å‘¼ã³å‡ºã—ãŒæ¥½ã«ãªã‚‹ã®ã§å¤‰æ›´ã—ã¦ãŠãã¾ã™ã€‚

## ç’°å¢ƒå¤‰æ•°ã®pathã‚’é€šã™
pathã‚’é€šã™ãƒ•ã‚©ãƒ«ãƒ€ã«exeãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç§»å‹•ã€‚ã“ã“ã§ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ã‚©ãƒ«ãƒ€ç›´ä¸‹ã«ç§»å‹•ã—ã¾ã™ã€‚
:::message
ä¾‹ï¼‰C:\Users\unsol\jq.exe
:::

ãƒ¦ãƒ¼ã‚¶ãƒ¼ç’°å¢ƒå¤‰æ•°ã®`Path`ã‚’é¸æŠã—ã¦ã€Œç·¨é›†ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã€‚
![](https://storage.googleapis.com/zenn-user-upload/0mr5wep4jr2iekz8if0tp5l4s2ix)
ã€Œæ–°è¦ã€ã§å…ˆã»ã©exeãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç½®ã„ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ã‚©ãƒ«ãƒ€ï¼ˆã“ã“ã§ã¯`C:\Users\unsol`ï¼‰ã‚’è¿½åŠ ã€‚
![](https://storage.googleapis.com/zenn-user-upload/yp6oq6qoeps2xy4wdr4kx8nnaskc)
ã€ŒOKã€ã‚’æŠ¼ã—ã¦é–‰ã˜ã¾ã™ã€‚

:::message alert
å ´åˆã«ã‚ˆã£ã¦ã¯å†èµ·å‹•ãŒå¿…è¦ã¨ãªã‚Šã¾ã™
:::
## ã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œç¢ºèª
ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚„bashã‚¿ãƒ¼ãƒŸãƒŠãƒ«ç­‰ã‚’é–‹ã„ã¦jqã‚³ãƒãƒ³ãƒ‰ãŒä½¿ãˆã‚‹ã‚ˆã†ã«ãªã£ãŸã‹ç¢ºèªã—ã¾ã™ã€‚ä»¥ä¸‹ã‚³ãƒãƒ³ãƒ‰ã‚’å©ã„ã¦ã€å°å…¥ã—ãŸjqã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã‚Œã°OKã§ã™ã€‚
```shell
$ jq -V
jq-1.6
```

ãƒ˜ãƒ«ãƒ—ã§ã‚³ãƒãƒ³ãƒ‰ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç­‰ã®è©³ç´°ã‚’å‚ç…§ã§ãã¾ã™ã€‚
```shell
$ jq --help
jq - commandline JSON processor [version 1.6]

Usage:  C:\Users\unsol\jq.exe [options] <jq filter> [file...]
        C:\Users\unsol\jq.exe [options] --args <jq filter> [strings...]
        C:\Users\unsol\jq.exe [options] --jsonargs <jq filter> [JSON_TEXTS...]

jq is a tool for processing JSON inputs, applying the given filter to
its JSON text inputs and producing the filter's results as JSON on
standard output.

The simplest filter is ., which copies jq's input to its output
unmodified (except for formatting, but note that IEEE754 is used
for number representation internally, with all that that implies).

For more advanced filters see the jq(1) manpage ("man jq")
and/or https://stedolan.github.io/jq

Example:

        $ echo '{"foo": 0}' | jq .
        {
                "foo": 0
        }

Some of the options include:
  -c               compact instead of pretty-printed output;
  -n               use `null` as the single input value;
  -e               set the exit status code based on the output;
  -s               read (slurp) all inputs into an array; apply filter to it;
  -r               output raw strings, not JSON texts;
  -R               read raw strings, not JSON texts;
  -C               colorize JSON;
  -M               monochrome (don't colorize JSON);
  -S               sort keys of objects on output;
  --tab            use tabs for indentation;
  --arg a v        set variable $a to value <v>;
  --argjson a v    set variable $a to JSON value <v>;
  --slurpfile a f  set variable $a to an array of JSON texts read from <f>;
  --rawfile a f    set variable $a to a string consisting of the contents of <f>;
  --args           remaining arguments are string arguments, not files;
  --jsonargs       remaining arguments are JSON arguments, not files;
  --               terminates argument processing;

Named arguments are also available as $ARGS.named[], while
positional arguments are available as $ARGS.positional[].

See the manpage for more options.
```
# ä½¿ç”¨ä¾‹
curlã‚³ãƒãƒ³ãƒ‰ã«`jq`ã‚’ãƒ‘ã‚¤ãƒ—ã§ç¹‹ã’ã‚‹ã ã‘ã§ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒæ•´å½¢ã•ã‚Œã¦å‡ºåŠ›ã•ã‚Œã¾ã™ã€‚å†’é ­ã§ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã•ã‚Œã¦ã‚ˆãã‚ã‹ã‚‰ãªã‹ã£ãŸæ—¥æœ¬èªéƒ¨åˆ†ã‚‚ã€æ™®é€šã«èª­ã‚ã‚‹å½¢ã§å‡ºåŠ›ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚
```shell
$ curl -s "http://geoapi.heartrails.com/api/json?method=searchByPostal&postal=1620067" | jq
{
  "response": {
    "location": [
      {
        "city": "æ–°å®¿åŒº",
        "city_kana": "ã—ã‚“ã˜ã‚…ãã",
        "town": "å¯Œä¹…ç”º",
        "town_kana": "ã¨ã¿ã²ã•ã¡ã‚‡ã†",
        "x": "139.716002",
        "y": "35.693258",
        "prefecture": "æ±äº¬éƒ½",
        "postal": "1620067"
      }
    ]
  }
}
```

ãƒ•ã‚£ãƒ«ã‚¿ã‚’ä½¿ãˆã°ã€JSONã‹ã‚‰å¿…è¦ãªæƒ…å ±ã ã‘ã‚’ã‚µã‚¯ãƒƒã¨å–å¾—ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

```shell
$ curl -s "http://geoapi.heartrails.com/api/json?method=searchByPostal&postal=1620067" | jq '.response.location[] | [.prefecture, .town, .city]'
[
  "æ±äº¬éƒ½",
  "å¯Œä¹…ç”º",
  "æ–°å®¿åŒº"
]
```

éšå±¤ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æŒ‡å®šã‚„ã‚½ãƒ¼ãƒˆãªã©ã€ã‚ˆã‚Šé«˜åº¦ã«jqã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã„ã“ãªã—ãŸã„æ–¹ã¯å…¬å¼ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã‚’ã”å‚ç…§ãã ã•ã„ã€‚
:::message
[jq Manual (development version)](https://stedolan.github.io/jq/manual/)
:::
