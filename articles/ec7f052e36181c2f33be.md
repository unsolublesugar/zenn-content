---
title: "PowerShellã®ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œå±¥æ­´ã‚’å–å¾—ã™ã‚‹æ–¹æ³•"
emoji: "ğŸªŸ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [Windows, powershell]
published: true
publication_name: "easy_easy"
---
# PowerShellã®ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œå±¥æ­´ã‚’ç¢ºèªã—ãŸã„

Windowsã§PowerShellã®ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œå±¥æ­´ã‚’ç¢ºèªã—ãŸã‹ã£ãŸã®ã§ã€ã‚„ã‚Šæ–¹ã‚’èª¿ã¹ã¦ã¿ãŸã€‚
ã„ãã¤ã‹æ–¹æ³•ãŒã‚ã£ãŸã®ã§ãƒ¡ãƒ¢ã—ã¦ãŠãã€‚æœ¬è¨˜äº‹ã§ç´¹ä»‹ã™ã‚‹ã®ã¯ä»¥ä¸‹3ã¤ã®ã‚³ãƒãƒ³ãƒ‰ã«ã¤ã„ã¦ã€‚

1. Get-History
2. Get-PSReadLineOption
3. Start-Transcript

# Get-History

[Get-History](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/get-history?view=powershell-7.1)ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã†ã¨ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³å†…ã§å®Ÿè¡Œã—ãŸã‚³ãƒãƒ³ãƒ‰å±¥æ­´ä¸€è¦§ãŒå–å¾—ã§ãã‚‹ã€‚

```shell
Get-History
   [[-Id] <Int64[]>]
   [[-Count] <Int32>]
   [<CommonParameters>]
```

## å®Ÿè¡Œä¾‹
```shell
> Get-History

  Id CommandLine
  -- -----------
   1 git -v
   2 electron -v
   3 npx create-electron-app my-electron-app
   4 cd my-electron-app
   5 npm start
```
ç›´è¿‘ã®ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œå±¥æ­´ã‚’ã‚µã‚¯ãƒƒã¨è¦‹ãŸã„ãªã‚‰ã“ã‚Œã€‚


# Get-PSReadLineOption
ç¾åœ¨å®Ÿè¡Œä¸­ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã ã‘ã§ã¯ãªãã€ä»¥å‰ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§å®Ÿè¡Œã—ãŸã‚³ãƒãƒ³ãƒ‰å±¥æ­´ã‚‚å–å¾—ã—ãŸã„å ´åˆã¯[Get-PSReadLineOption](https://docs.microsoft.com/en-us/powershell/module/psreadline/get-psreadlineoption?view=powershell-7.1)ã®`HistorySavePath`ã‚’ä½¿ã†ã€‚

```shell
Get-PSReadLineOption []
```

## å®Ÿè¡Œä¾‹
`(Get-PSReadlineOption).HistorySavePath`ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œãƒ­ã‚°ãŒè¨˜éŒ²ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã€‚

```shell
> (Get-PSReadlineOption).HistorySavePath
C:\Users\unsol\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt
```
`ConsoleHost_history.txt` ã¨ã„ã†ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒ­ã‚°ãŒä¿å­˜ã•ã‚Œã¦ã„ã‚‹ã€‚

```shell:ConsoleHost_history.txt
git -v
npx create-electron-app my-electron-app
electron -v
node_modules\.bin\electron --version
ls
cd my-electron-app
npm start
npm run make
npx electron
npx electron --version
npm install -D electron-builder
npx electron-builder --help
npx electron-builder --win --x64
npm prune --production
npx electron-builder --win --x64
(Get-PSReadlineOption).HistorySavePath
```

å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰ã ã‘ã‚’è¦‹ãŸã„ãªã‚‰ååˆ†ã ã‘ã©ã€æŠ€è¡“ç³»ã®è¨˜äº‹ã‚’æ›¸ãæ™‚ã«ã¯ã‚³ãƒãƒ³ãƒ‰ã®å‡ºåŠ›çµæœã‚‚ç¢ºèªã—ãŸã„ã€‚

# Start-Transcript
[Start-Transcript](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.host/start-transcript?view=powershell-7.1) ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã†ã¨ã€ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œå¾Œã®å…¥å‡ºåŠ›å†…å®¹ã‚’ã™ã¹ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã«å‡ºåŠ›ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚

```shell
Start-Transcript
     [[-Path] <String>]
     [-Append]
     [-Force]
     [-NoClobber]
     [-IncludeInvocationHeader]
     [-UseMinimalHeader]
     [-WhatIf]
     [-Confirm] 
     [<CommonParameters>]
```
## å®Ÿè¡Œä¾‹

### ã‚³ãƒãƒ³ãƒ‰ã®å…¥å‡ºåŠ›è¨˜éŒ²é–‹å§‹
```shell
> Start-Transcript ps_log.txt -append
```

### ã‚³ãƒãƒ³ãƒ‰ã®å…¥å‡ºåŠ›è¨˜éŒ²åœæ­¢
```shell
> Stop-Transcript
```

### å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«

```shell:ps_log.txt
**********************
Windows PowerShell ãƒˆãƒ©ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆé–‹å§‹
é–‹å§‹æ™‚åˆ»: 20201212175308
ãƒ¦ãƒ¼ã‚¶ãƒ¼å: AURORA\unsol
RunAs ãƒ¦ãƒ¼ã‚¶ãƒ¼: AURORA\unsol
æ§‹æˆå: 
ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼: AURORA (Microsoft Windows NT 10.0.18363.0)
ãƒ›ã‚¹ãƒˆ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
ãƒ—ãƒ­ã‚»ã‚¹ ID: 84224
PSVersion: 5.1.18362.1110
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.18362.1110
BuildVersion: 10.0.18362.1110
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
ãƒˆãƒ©ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒé–‹å§‹ã•ã‚Œã¾ã—ãŸã€‚å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«: ps_log.txt
PS C:\Users\unsol> git -v
unknown option: -v
usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]
           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]
           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]
           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]
           <command> [<args>]
PS C:\Users\unsol> electron -v

v11.0.2
PS C:\Users\unsol> npx create-electron-app my-electron-app
âˆš  Initializing Project Directory
âˆš  Initializing Git Repository
âˆš  Locating custom template: "base"
âˆš  Copying Starter Files
âˆš  Initializing NPM Module
âˆš  Installing Template Dependencies
âˆš  Installing NPM Dependencies
PS C:\Users\unsol> cd my-electron-app
PS C:\Users\unsol\my-electron-app> npm start

> my-electron-app@1.0.0 start C:\Users\unsol\my-electron-app
> electron-forge start

âˆš  Checking your system
âˆš  Locating Application
âˆš  Preparing native dependencies
âˆš  Launching Application

(node:84508) electron: The default of contextIsolation is deprecated and will be changing from false to true in a future
 release of Electron.  See https://github.com/electron/electron/issues/23506 for more information
ãƒ ãƒƒ ãƒ  ã‚¸ ãƒ§ ãƒ– ã‚’ çµ‚ äº† ã— ã¾ ã™ ã‹  (Y/N)? t
ãƒ ãƒƒ ãƒ  ã‚¸ ãƒ§ ãƒ– ã‚’ çµ‚ äº† ã— ã¾ ã™ ã‹  (Y/N)? y
PS C:\Users\unsol\my-electron-app> çµ‚äº†ã‚¨ãƒ©ãƒ¼(): "ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ãŒåœæ­¢ã•ã‚Œã¦ã„ã¾ã™ã€‚"
>> çµ‚äº†ã‚¨ãƒ©ãƒ¼(): "ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ãŒåœæ­¢ã•ã‚Œã¦ã„ã¾ã™ã€‚"
PS C:\Users\unsol\my-electron-app> Stop-Transcript
**********************
Windows PowerShell ãƒˆãƒ©ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆçµ‚äº†
çµ‚äº†æ™‚åˆ»: 20201212175553
**********************
```

è‹¥å¹²ä½™è¨ˆãªå‡ºåŠ›ã‚‚å…¥ã£ã¦ã„ã‚‹ãŒã€PowerShellã®å…¥å‡ºåŠ›å†…å®¹ã™ã¹ã¦ãŒç¢ºèªã§ãã‚‹ã€‚
![](https://storage.googleapis.com/zenn-user-upload/7p6lnpdrzdibmou12s34cqr407sv)


ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«æ©Ÿèƒ½ã‚’åˆ©ç”¨ã™ã‚Œã°è‡ªå‹•ã§ãƒ­ã‚°å‡ºåŠ›ã‚‚ã§ãã‚‹ã£ã½ã„ã€‚
https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_profiles?view=powershell-7.1

ä¾¿åˆ©ã€‚
